zabbix_export:
  version: '7.2'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 299c35b3518b454f809c8e6af68cc73f
      template: 'WB by m-e'
      name: 'Wirenboard by mqtt-exporter'
      description: 'https://github.com/Kolunchik/mqtt-exporter'
      vendor:
        name: 'https://github.com/Kolunchik/mqtt-exporter'
        version: 1.0.0
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 72d62928c7c6448ca96c0ed81b400f87
          name: '{$N_MQTT}: Служебные метрики mqtt-exporter'
          type: HTTP_AGENT
          key: 'exporter[metrics]'
          history: 1d
          value_type: TEXT
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: JSONPATH
              parameters:
                - $.body
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          url: '{$M_URL}/health'
          output_format: JSON
          tags:
            - tag: mqtt
              value: mqtt-exporter
          triggers:
            - uuid: 8ff2a2302eab48d6b20aef4f640d016e
              expression: 'last(/WB by m-e/exporter[metrics])=0'
              name: '{$N_MQTT}: Не могу получить служебные метрики mqtt-exporter'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: error
                  value: mqtt-exporter
        - uuid: cb3178df839d4b3885e5e7a28f4a007b
          name: '{$N_MQTT}: mqtt-exporter подключен к MQTT-брокеру'
          type: DEPENDENT
          key: 'exporter[mqtt_connected]'
          history: 1d
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.[?(@.topic==''mqtt_connected'')].value.first()'
          master_item:
            key: 'exporter[metrics]'
          tags:
            - tag: mqtt
              value: mqtt-exporter
          triggers:
            - uuid: 77765db33a80437da35fde90fe76c3f5
              expression: 'last(/WB by m-e/exporter[mqtt_connected])<>1'
              name: '{$N_MQTT}: mqtt-exporter не подключен к брокеру'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                - tag: error
                  value: mqtt-exporter
        - uuid: dcfa7fa375014a04b972d6d951d3ec53
          name: '{$N_MQTT}: Количество выполненных подключений к MQTT-брокеру'
          type: DEPENDENT
          key: 'exporter[mqtt_connections_total]'
          history: 1d
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.[?(@.topic==''mqtt_connections_total'')].value.first()'
          master_item:
            key: 'exporter[metrics]'
          tags:
            - tag: mqtt
              value: mqtt-exporter
          triggers:
            - uuid: d090a77b8e784918a375d869b16c0b23
              expression: 'last(/WB by m-e/exporter[mqtt_connections_total],#1)-last(/WB by m-e/exporter[mqtt_connections_total],#5)>3'
              name: '{$N_MQTT}: mqtt-exporter необычно часто переподключается к брокеру'
              manual_close: 'YES'
              tags:
                - tag: error
                  value: mqtt-exporter
        - uuid: f9075bce509c4677bbce69321c0e9b4c
          name: '{$N_MQTT}: Время работы mqtt-exporter'
          type: DEPENDENT
          key: 'exporter[uptime_seconds]'
          history: '{$INPUT_HISTORY}'
          trends: '{$INPUT_TREND}'
          units: uptime
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.metrics.[?(@.topic==''uptime_seconds'')].value.first()'
          master_item:
            key: 'exporter[metrics]'
          tags:
            - tag: mqtt
              value: mqtt-exporter
            - tag: type
              value: uptime
          triggers:
            - uuid: eb4f57af09fa4f6db3768d0bcecd33da
              expression: 'last(/WB by m-e/exporter[uptime_seconds])<{$CHECK_NODATA}'
              name: '{$N_MQTT}: mqtt-exporter был перезапущен'
              manual_close: 'YES'
              tags:
                - tag: error
                  value: mqtt-exporter
            - uuid: 27a4950a52404f8e82798379107ab432
              expression: 'nodata(/WB by m-e/exporter[uptime_seconds],{$CHECK_NODATA})=1'
              name: '{$N_MQTT}: Давно не поступали данные о времени работы mqtt-exporter'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: error
                  value: nodata
        - uuid: 03779a72f67742ecb41771e15c52e842
          name: '{$N_MQTT}: Метрики mqtt'
          type: HTTP_AGENT
          key: 'mqtt[metrics]'
          history: 1d
          value_type: TEXT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.body
          url: '{$M_URL}/metrics'
          output_format: JSON
          tags:
            - tag: mqtt
              value: system
            - tag: type
              value: master
        - uuid: 02fbf6e8a7d5436e945f0d3de4dbddc5
          name: '{$N_MQTT}: Напряжение питания контроллера'
          type: DEPENDENT
          key: 'mqtt[system/Vin]'
          history: '{$INPUT_HISTORY}'
          value_type: FLOAT
          trends: '{$INPUT_TREND}'
          units: V
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.["/devices/wb-adc/controls/Vin"].value'
          master_item:
            key: 'mqtt[metrics]'
          tags:
            - tag: mqtt
              value: system
            - tag: type
              value: Vin
          triggers:
            - uuid: a604481444b343388a63e0a4550beb69
              expression: 'max(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})-min(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})>{$VOLTAGE_MAX_DELTA}'
              name: '{$N_MQTT}: Болтается напряжение питания контроллера'
              description: 'возможно, блок питания собирается попрощаться с нами'
              manual_close: 'YES'
              dependencies:
                - name: '{$N_MQTT}: Напряжение питания контроллера ниже {$VOLTAGE_MIN} V'
                  expression: 'avg(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})<{$VOLTAGE_MIN}'
                  recovery_expression: 'avg(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})>{$VOLTAGE_MIN_OK}'
              tags:
                - tag: error
                  value: system
            - uuid: 135703afe0f44999ab344e0cd47feca1
              expression: 'nodata(/WB by m-e/mqtt[system/Vin],{$CHECK_NODATA})=1'
              name: '{$N_MQTT}: Давно не поступали данные о напряжении питания контроллера'
              priority: INFO
              manual_close: 'YES'
              tags:
                - tag: error
                  value: nodata
            - uuid: cf826c3e9228472081f387c3882984fa
              expression: 'avg(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})<{$VOLTAGE_MIN}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/WB by m-e/mqtt[system/Vin],{$CHECK_INTERVAL})>{$VOLTAGE_MIN_OK}'
              name: '{$N_MQTT}: Напряжение питания контроллера ниже {$VOLTAGE_MIN} V'
              priority: INFO
              manual_close: 'YES'
              dependencies:
                - name: '{$N_MQTT}: Давно не поступали данные о напряжении питания контроллера'
                  expression: 'nodata(/WB by m-e/mqtt[system/Vin],{$CHECK_NODATA})=1'
              tags:
                - tag: error
                  value: system
      discovery_rules:
        - uuid: 45f7d2ebf9a4403a92a01b8af6b79ed8
          name: msu24hit
          type: TRAP
          key: msu24hit.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: caf60a81c9744c6a9e299da0430e2e90
              name: '{#NAME}: Влажность'
              type: DEPENDENT
              key: 'msu24hit[{#DEVICE}/Humidity]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: '%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Humidity"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 4859b086ebb34719a2165db6192b1eac
                  expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Humidity],{$CHECK_INTERVAL})>{$HUMID_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Humidity],{$CHECK_INTERVAL})<{$HUMID_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Высокая влажность'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: humid
                      value: high
            - uuid: 39e7baf96b9845c3bbeabdc44a14092d
              name: '{#NAME}: Освещённость'
              type: DEPENDENT
              key: 'msu24hit[{#DEVICE}/Illuminance]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              units: lx
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Illuminance"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
            - uuid: 481cc5e7a9bf437a879fe96363cfaa4d
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'msu24hit[{#DEVICE}/Temp/error]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temp/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: fd06fb71018b4e81a2c96147c6d56621
                  expression: 'last(/WB by m-e/msu24hit[{#DEVICE}/Temp/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 48e93fa6bcbb4112b1d0044b512faa2c
              name: '{#NAME}: Температура'
              type: DEPENDENT
              key: 'msu24hit[{#DEVICE}/Temp]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temp"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 367f84a199044a8782611004980d757d
                  expression: 'nodata(/WB by m-e/msu24hit[{#DEVICE}/Temp],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
                - uuid: 6ec99087fa6d49e885a1a869869aaa63
                  expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Temp],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Temp],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Жарко'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 459c98e6715e4e76b00a3cdfa32e1994
                  expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Temp],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/msu24hit[{#DEVICE}/Temp],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}"}'
                  name: '{#NAME}: Холодно'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 202b326208be4e0787f65de6b7f83075
          name: wb-map3e
          type: TRAP
          key: wb-map3e.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: 8e26e412de744e5b81c3a31a9fb3e4d7
              name: '{#NAME}: Прямая активная энергия L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/AP energy L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kWh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/AP energy L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 2ac8ae9fa77f4fbd91f9e62f2cc17dd9
              name: '{#NAME}: Прямая активная энергия L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/AP energy L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kWh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/AP energy L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 4c25022b313e43a188a07cd228436442
              name: '{#NAME}: Прямая активная энергия L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/AP energy L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kWh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/AP energy L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: aea209ecfca643d08b04f9ee95fa4014
              name: '{#NAME}: Частота'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Frequency]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: Hz
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Frequency"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: c5900295714042a580f375d04eca2a33
              name: '{#NAME}: Пиковый ток L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Ipeak L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Ipeak L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 1e812e4ebeba48e1bd8fe6b456a03161
              name: '{#NAME}: Пиковый ток L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Ipeak L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Ipeak L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: b9f9f5e58e634071b00d256ce27a7156
              name: '{#NAME}: Пиковый ток L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Ipeak L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Ipeak L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: f8dd525ac7b4405490a347a998ec45ff
              name: '{#NAME}: Ток L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Irms L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Irms L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 391d11dba1b04096b075de9fb3f632b5
              name: '{#NAME}: Ток L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Irms L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Irms L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 31ebcddf22964d93a2532e32e330cee0
              name: '{#NAME}: Ток L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Irms L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: A
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Irms L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 120fd6c70ced4c07977c83bb2d77307f
              name: '{#NAME}: Коэффициент мощности L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/PF L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/PF L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: cbcb7ef194ff4733a0c29c79793819d4
              name: '{#NAME}: Коэффициент мощности L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/PF L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/PF L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: ab85d438f53c43b48467cb4e3829b246
              name: '{#NAME}: Коэффициент мощности L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/PF L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/PF L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: d9cd875788c44727a7d2506866ceb899
              name: '{#NAME}: Угол фазового сдвига между напряжением и током L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Phase angle L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Phase angle L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 9edbcf9f60904797be581dfd64cc2326
              name: '{#NAME}: Угол фазового сдвига между напряжением и током L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Phase angle L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Phase angle L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: a26dcae455f3412c8c9cc930c62aa0ce
              name: '{#NAME}: Угол фазового сдвига между напряжением и током L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Phase angle L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Phase angle L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: de690d226bc141b798b6d48578168051
              name: '{#NAME}: Активная мощность L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/P L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: W
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/P L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 8a068205b9da4873b441d4a191ecef58
              name: '{#NAME}: Активная мощность L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/P L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: W
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/P L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 54f20a0abc7042aa903e522ee25ae1b8
              name: '{#NAME}: Активная мощность L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/P L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: W
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/P L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 52520461291140a9a2ce5518de2fd2da
              name: '{#NAME}: Реактивная мощность L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Q L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: var
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Q L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 097581f09ed042739640a9080dd24d88
              name: '{#NAME}: Реактивная мощность L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Q L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: var
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Q L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: fbbe6b6776ee4f07b8dca2fed73dca8b
              name: '{#NAME}: Реактивная мощность L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Q L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: var
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Q L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 797929be5e7c49bf9cf245317c530718
              name: '{#NAME}: Прямая реактивная энергия L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/RP energy L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kvarh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/RP energy L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: aa1cbc0767f74cc691e74ecfb6414e91
              name: '{#NAME}: Прямая реактивная энергия L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/RP energy L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kvarh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/RP energy L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 7542ebe304b4446ebd327a0e84af9e6e
              name: '{#NAME}: Прямая реактивная энергия L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/RP energy L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kvarh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/RP energy L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: b98129a129954abba0c4eb1da39ff3a4
              name: '{#NAME}: Полная мощность L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/S L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: VA
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/S L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: d399d80dd3e045598fa31aa46d28fcd8
              name: '{#NAME}: Полная мощность L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/S L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: VA
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/S L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 36a8157549cc4d87871a58e322e0b13c
              name: '{#NAME}: Полная мощность L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/S L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: VA
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/S L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 340ea99775b6421eb693b2b6fd305daf
              name: '{#NAME}: Суммарная прямая активная энергия'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total AP energy]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kWh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total AP energy"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 7c3c1392441f41b688086a892feaa018
              name: '{#NAME}: Суммарный коэффициент мощности'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total PF]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total PF"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 900589802f674d53bd068f9791249261
              name: '{#NAME}: Суммарная активная мощность'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total P]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: W
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total P"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: eba037d2eba84d68bd3ccd178ae9c964
              name: '{#NAME}: Суммарная реактивная мощность'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total Q]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: var
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total Q"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: e5bfb7e25d964d2e8a2c8e11d36ded3f
              name: '{#NAME}: Суммарная прямая реактивная энергия'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total RP energy]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: kWh
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total RP energy"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 43112645fa3d4997a5416698a0e81179
              name: '{#NAME}: Суммарная кажущаяся мощность'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Total S]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: VA
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Total S"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 959a24f15a4248faac7dd3b51e979871
              name: '{#NAME}: Пиковое напряжение L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Upeak L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Upeak L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 396bae22dc6e47ecac1ace72e8a7d259
              name: '{#NAME}: Пиковое напряжение L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Upeak L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Upeak L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 70ae9761916a4843b5fbaf5b27677541
              name: '{#NAME}: Пиковое напряжение L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Upeak L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Upeak L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: e169bc14b53e40d183184340d1e4d27b
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Urms L1/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Urms L1/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: bd83bcaa74d543af9ff5d7b4badbe064
                  expression: 'last(/WB by m-e/wb-map3e[{#DEVICE}/Urms L1/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: d95c89efb5bf4a3ba488822557dc999e
              name: '{#NAME}: Напряжение L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Urms L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Urms L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
              trigger_prototypes:
                - uuid: 933100e4ddef4a7ba7d9f64d5af7ea9a
                  expression: 'nodata(/WB by m-e/wb-map3e[{#DEVICE}/Urms L1],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
            - uuid: 98cdae5aed21492db13c0fb5ff9a0d01
              name: '{#NAME}: Напряжение L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Urms L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Urms L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: 963c345b76c64603984a1e31607afb54
              name: '{#NAME}: Напряжение L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Urms L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Urms L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: e2811075977941f7be3a834127abf8ef
              name: '{#NAME}: Фазовый угол сдвига напряжения между фазами L1 и L1'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Voltage angle L1]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Voltage angle L1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: a589f461a42b43859240c20b853ecfb1
              name: '{#NAME}: Фазовый угол сдвига напряжения между фазами L1 и L2'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Voltage angle L2]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Voltage angle L2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
            - uuid: fbc45e0ed4454a4fa8cd887567ca59ed
              name: '{#NAME}: Фазовый угол сдвига напряжения между фазами L1 и L3'
              type: DEPENDENT
              key: 'wb-map3e[{#DEVICE}/Voltage angle L3]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: °
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Voltage angle L3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: electricity
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 5a67c20e968749648d3791e2de85f7d6
          name: wb-mcm16
          type: TRAP
          key: wb-mcm16.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: ad9881cf68b748428fdd89c4e006f2d8
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter1/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter1/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: d1678b4e3b764140b454748a130fa3e3
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Counter1/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: e541a3b276f84d7bad48c434a4563365
              name: '{#NAME}: {$N_{#MACRO}:I1} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 1ed36f7892334e348186281310c40455
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 1])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I1}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 1])=1'
            - uuid: e36c62f20699491a8e1c49c42074332c
              name: '{#NAME}: {$N_{#MACRO}:I2} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: d7927ef079354cbd9b53a6b73e7f677b
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 2])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I2}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 2])=1'
            - uuid: fe0a9e499f0a40ddba758813c0343f68
              name: '{#NAME}: {$N_{#MACRO}:I3} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: de449ddd1e9b4fc5a9a4f0e7a46ced20
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 3])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I3}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 3])=1'
            - uuid: 21ab923caa0e4ff5a0c42f9d5fa8d481
              name: '{#NAME}: {$N_{#MACRO}:I4} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 4]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter4"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: b9fce311af2249398ad23682e9b2087f
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 4])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I4}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I4}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 4])=1'
            - uuid: 540a4be7e98c4943bd0feff6e60b3625
              name: '{#NAME}: {$N_{#MACRO}:I5} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 5]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter5"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 1c9ea20e55434e688401ce10a4d4f637
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 5])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I5}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I5}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 5])=1'
            - uuid: 3a740d27377f4a189842d88ae683a5d8
              name: '{#NAME}: {$N_{#MACRO}:I6} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 6]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter6"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 16771ac2ab7d4c77a104e94645670790
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 6])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I6}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I6}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 6])=1'
            - uuid: c07faebc142545c9a8971966427a5fee
              name: '{#NAME}: {$N_{#MACRO}:I7} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 7]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter7"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 60fb72446f104b0aa30eebb125f12ad3
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 7])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I7}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I7}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 7])=1'
            - uuid: 38ffacb39bb3438ab2895ca507173d33
              name: '{#NAME}: {$N_{#MACRO}:I8} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 8]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter8"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 1b72d9864bd24c8da0501fc780cd9d31
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 8])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I8}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I8}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 8])=1'
            - uuid: 71b3ac02502e4056aa0ec8217156aa57
              name: '{#NAME}: {$N_{#MACRO}:I9} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 9]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter9"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: a0aa8351ff0c420c88abc22f81546674
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 9])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I9}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I9}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 9])=1'
            - uuid: 4a06b24695d7494190cae6d5e1266f60
              name: '{#NAME}: {$N_{#MACRO}:I10} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 10]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter10"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 2e23232731ba4f31aa133eba716f413b
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 10])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I10}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I10}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 10])=1'
            - uuid: cbb7511c2c8a42cba272c6f3d1a1b550
              name: '{#NAME}: {$N_{#MACRO}:I11} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 11]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter11"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 3ebb49e7aa67437ba539171650cda4ea
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 11])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I11}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I11}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 11])=1'
            - uuid: 763e0b2900604fbb8cd42f180142b5dc
              name: '{#NAME}: {$N_{#MACRO}:I12} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 12]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter12"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 59dea142f7dd455da01ae9673a9d1274
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 12])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I12}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I12}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 12])=1'
            - uuid: 868dace382624a80989bb1179707761d
              name: '{#NAME}: {$N_{#MACRO}:I13} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 13]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter13"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: a20fda1c3f354dc3a53ceaba68f0a0ae
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 13])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I13}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I13}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 13])=1'
            - uuid: edf5d96b43514ef6af85255938694783
              name: '{#NAME}: {$N_{#MACRO}:I14} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 14]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter14"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 390e4a1f8dce4e089fb1075a71c8e9df
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 14])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I14}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I14}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 14])=1'
            - uuid: 7efdb016fcd64bfcbdea82a85eaa6fe1
              name: '{#NAME}: {$N_{#MACRO}:I15} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 15]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter15"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: a3175d337d604c739db31f27549e9414
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 15])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I15}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I15}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 15])=1'
            - uuid: 6b80d5553eab406888920b6c10a10d53
              name: '{#NAME}: {$N_{#MACRO}:I16} (счетчик)'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Counter 16]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Counter16"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: de5e086bdf4d4407b8c518bf7bedca66
                  expression: 'change(/WB by m-e/wb-mcm16[{#DEVICE}/Counter 16])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I16}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I16}'
                      expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 16])=1'
            - uuid: 47aed94e9c62496e9a5813e5e8de5f3a
              name: '{#NAME}: {$N_{#MACRO}:I1}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input1"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 7321c197511e4eac9ee98472fc09b3a6
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: ca15326c938146a692863965a2f322c2
              name: '{#NAME}: {$N_{#MACRO}:I2}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input2"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: a4f3f5ab0f2c4578a9083eb691b90cbd
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 0c48715db9c34e479339605b2a99c983
              name: '{#NAME}: {$N_{#MACRO}:I3}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input3"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 1144fdbcf1104f11aa5d35f6e7d5045a
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 3])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 920e363daeef4156802cb58744dab9e3
              name: '{#NAME}: {$N_{#MACRO}:I4}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 4]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input4"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 2212d902c25844c0aaff6666525c2259
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 4])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I4}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: e283aa65209f46eaa49d7b41cb5b6356
              name: '{#NAME}: {$N_{#MACRO}:I5}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 5]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input5"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 29765e8371204a019083700f5b7074b4
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 5])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I5}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 18424928c0ab45a0b7e2ac961d509b36
              name: '{#NAME}: {$N_{#MACRO}:I6}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 6]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input6"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d5704852b3cf4746ac372ced25c281ad
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 6])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I6}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 6fcc428e295742a9b8718bbf139eb7e1
              name: '{#NAME}: {$N_{#MACRO}:I7}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 7]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input7"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 506fa083533644588abe9039f8f73b5b
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 7])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I7}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: f394d78aeac64bb8a6084378cf1f762f
              name: '{#NAME}: {$N_{#MACRO}:I8}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 8]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input8"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d0db4c9bae1c465a9632ae3010a414b0
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 8])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I8}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: e38a29ff5a1c44648990beca7ab815c1
              name: '{#NAME}: {$N_{#MACRO}:I9}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 9]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input9"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 4f782e6d25424851a14a9d3c1f36fb08
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 9])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I9}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 8cee64a3e67b41a5a3d9cfc64aef4f17
              name: '{#NAME}: {$N_{#MACRO}:I10}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 10]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input10"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 85e34a9abf4240feb06fdac2f248c8e4
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 10])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I10}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 288aba9cb0374b1595de60b23a8081d7
              name: '{#NAME}: {$N_{#MACRO}:I11}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 11]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input11"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 20be0e2bc3db4065b122c7ee2380c4f2
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 11])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I11}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 41e3c19903aa474988522584822080cf
              name: '{#NAME}: {$N_{#MACRO}:I12}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 12]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input12"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 939934617b8a46139d187e1443c43cab
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 12])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I12}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: c07fc74f22fb499ba75d6a27623e78f1
              name: '{#NAME}: {$N_{#MACRO}:I13}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 13]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input13"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d247f9f4bc2b49f8a028d79db8f744fa
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 13])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I13}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 5106a5485d894946bd431d422c9c2650
              name: '{#NAME}: {$N_{#MACRO}:I14}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 14]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input14"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: f83d44da375d49138050186afb728d0c
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 14])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I14}'
                  priority: AVERAGE
                  manual_close: 'YES'
                - uuid: 042ff4f3a71b442da598f2fa825b8b6d
                  expression: '(nodata(/WB by m-e/wb-mcm16[{#DEVICE}/Input 14],{$CHECK_NODATA:"{#MACRO}"})=1) or (changecount(/WB by m-e/wb-mcm16[{#DEVICE}/Input 14],{$CHECK_NODATA:"{#MACRO}"})=0)'
                  name: '{#NAME}: {$N_{#MACRO}:I14} давно не включался'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
            - uuid: 4ad280900dfe46c8adab98c1b4039c29
              name: '{#NAME}: {$N_{#MACRO}:I15}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 15]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input15"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: c34f044a344a469ca5dc888becaa9fa6
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 15])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I15}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 5cc4a3d666a045a8929fa6759faf4f4f
              name: '{#NAME}: {$N_{#MACRO}:I16}'
              type: DEPENDENT
              key: 'wb-mcm16[{#DEVICE}/Input 16]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input16"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 7c0bc82521674aac92da153d76dc2219
                  expression: 'last(/WB by m-e/wb-mcm16[{#DEVICE}/Input 16])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I16}'
                  priority: AVERAGE
                  manual_close: 'YES'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 9acb3fcb03114206819878f7aa6ef903
          name: wb-mr3
          type: TRAP
          key: wb-mr3.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: 39fb4c9fc5434b258021ad90a4343e6b
              name: '{#NAME}: {$N_{#MACRO}:I0}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 0]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 0"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
            - uuid: 130e081b728649548afcc157d2ccdbbe
              name: '{#NAME}: {$N_{#MACRO}:I1} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 1 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 9540460397fe4f97a30976c3170bc666
                  expression: 'change(/WB by m-e/wb-mr3[{#DEVICE}/Input 1 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I1}'
                      expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 1])=1'
            - uuid: 22fb0e5453a44db0b86e3a95d543560f
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 1/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: 26ae3d4b841040b79a5feb5fe76d8399
                  expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 1/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 7dcb389f0f974b28b661bffad0f3a1cf
              name: '{#NAME}: {$N_{#MACRO}:I1}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 3b5a4c4f2efb402389248dbbfb2b3998
                  expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 13b31c66fd564b788d7df5ddf733a320
              name: '{#NAME}: {$N_{#MACRO}:I2} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 2 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 2 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 148fd24683f44cb285fff0695f4295d0
                  expression: 'change(/WB by m-e/wb-mr3[{#DEVICE}/Input 2 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I2}'
                      expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 2])=1'
            - uuid: 64510462d94640639083bf232f08cdab
              name: '{#NAME}: {$N_{#MACRO}:I2}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 6f59dfac496840a3b4484c4090b1b9d8
                  expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 4319e41790fc46d3858381c4ce68ef88
              name: '{#NAME}: {$N_{#MACRO}:I3} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 3 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 3 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 6d9864e323bc46809895a742f4cab2a1
                  expression: 'change(/WB by m-e/wb-mr3[{#DEVICE}/Input 3 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I3}'
                      expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 3])=1'
            - uuid: 66d6d1044d0848fb8315dabd5384392b
              name: '{#NAME}: {$N_{#MACRO}:I3}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Input 3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 982d644c505344e19e49c2024892823b
                  expression: 'last(/WB by m-e/wb-mr3[{#DEVICE}/Input 3])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 7190a855e02445288cb769adaa4c2e55
              name: '{#NAME}: {$N_{#MACRO}:K1}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/K1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 21522611fca74579b2d53b369bfec66c
              name: '{#NAME}: {$N_{#MACRO}:K2}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/K2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: b61fdbc9047f4440b168252abf6b4b2b
              name: '{#NAME}: {$N_{#MACRO}:K3}'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/K3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 76a326731f934635a8a87a7865c0c29a
              name: '{#NAME}: Напряжение питания датчика'
              type: DEPENDENT
              key: 'wb-mr3[{#DEVICE}/Supply Voltage]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Supply Voltage"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: Vin
              trigger_prototypes:
                - uuid: 930b7027fd7445d6a769a442632c8add
                  expression: 'nodata(/WB by m-e/wb-mr3[{#DEVICE}/Supply Voltage],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: db9bd63e46f941a2bfdb33fbc276eb77
          name: wb-mr11
          type: TRAP
          key: wb-mr11.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: a5be047655a646d1a97c9ff4cb1b9165
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/controls/Input 1/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: 5f4b419ab19b498aa4adcda9f8dbefe5
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/controls/Input 1/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 437fa36377364c91a7f3f0aaf3d799bd
              name: '{#NAME}: {$N_{#MACRO}:I1} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 1 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 76e119ba543444ce8ca4a86e828816cb
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 1 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I1}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 1])=1'
            - uuid: 1dcced7273344f7492de26109a729553
              name: '{#NAME}: {$N_{#MACRO}:I1}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: e619bae41dcd451abd467c9f7de6cf48
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I1}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: ebd9466bea2443c7974e556c3e57e331
              name: '{#NAME}: {$N_{#MACRO}:I2} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 2 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 2 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 1db7d88a6d014403ac7be37e722937c5
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 2 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I2}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 2])=1'
            - uuid: 17a00fd71808481c8e0ea54ea3f9b77f
              name: '{#NAME}: {$N_{#MACRO}:I2}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 4cb2986667f1450ba9e16caff6279608
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I2}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: d8f2ab9d97f449d3a8d52465da5e15e6
              name: '{#NAME}: {$N_{#MACRO}:I3} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 3 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 3 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 612ad74d882448048884ad62ad3d20d4
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 3 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I3}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 3])=1'
            - uuid: d24f7195a53847be905463f1fd60454f
              name: '{#NAME}: {$N_{#MACRO}:I3}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 067ad2726a7a40d7bbc3e6ab8444ab8e
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 3])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I3}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: dc8d7ce9ce0744c8a26d078ce6dff742
              name: '{#NAME}: {$N_{#MACRO}:I4} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 4 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 4 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 2da25096cfbd4777a13042f73a7d24b1
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 4 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I4}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I4}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 4])=1'
            - uuid: 46ce151d6546409386fb7d0ddf988f1b
              name: '{#NAME}: {$N_{#MACRO}:I4}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 4]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 4"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: e296aa3360d049c695ea8d7c4826d3f7
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 4])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I4}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 8d7468c88d6546f0ba275cb12811595b
              name: '{#NAME}: {$N_{#MACRO}:I5} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 5 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 5 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: ee339cd17b7f40da990e4d46da033486
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 5 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I5}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I5}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 5])=1'
            - uuid: 18f972c511a74f3199814d647f83115a
              name: '{#NAME}: {$N_{#MACRO}:I5}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 5]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 5"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: c1e18c699ebb4c3686a564d2aac13e72
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 5])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I5}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 32c0d3c1d6ca47e791003c9f0ce0990e
              name: '{#NAME}: {$N_{#MACRO}:I6} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 6 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 6 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 795a1453946a4d9fbf61b0326ae00b94
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 6 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I6}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I6}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 6])=1'
            - uuid: 18a1ca96374c4ff9beb430a2e79a71a2
              name: '{#NAME}: {$N_{#MACRO}:I6}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 6]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 6"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 8e5237c701804b5680bf3d1ca00fbca5
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 6])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I6}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 88f959aa92d34dc2ac2336cb4976c6f4
              name: '{#NAME}: {$N_{#MACRO}:I7} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 7 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 7 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: ccf37303825148eaad74b83cb0a838b5
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 7 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I7}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I7}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 7])=1'
            - uuid: 7030ff90647a4a509de7c063f5af1161
              name: '{#NAME}: {$N_{#MACRO}:I7}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 7]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 7"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 9a2fceb09dea432f9be1d916f6d47f9b
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 7])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I7}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: b728d3dc56864e1fbff66152a7adf2f1
              name: '{#NAME}: {$N_{#MACRO}:I8} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 8 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 8 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 963b86c6062a4e28ac5f38befb747406
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 8 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I8}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I8}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 8])=1'
            - uuid: 58fd087cc9aa4821911174c50a5e04fb
              name: '{#NAME}: {$N_{#MACRO}:I8}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 8]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 8"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 363aeef1f84843738137cee38a89a2fa
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 8])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I8}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 10187aa9ecfb4e518bab62fcf3054f81
              name: '{#NAME}: {$N_{#MACRO}:I9} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 9 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 9 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: cde5e1db7f1b4f508f4da22a92ad1731
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 9 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I9}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I9}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 9])=1'
            - uuid: b375150319c149c7b7dbad57cad9a295
              name: '{#NAME}: {$N_{#MACRO}:I9}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 9]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 9"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 4451e98052a94e1a9983b7c3418f0dc1
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 9])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I9}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 6a4b7443157c4886a35b44ca1ccc5609
              name: '{#NAME}: {$N_{#MACRO}:I10} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 10 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 10 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: bcda1d97c8e644cfa6836bb7221e1edf
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 10 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I10}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I10}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 10])=1'
            - uuid: 59b25ac4cc2e497fb70ea848cc38fc6e
              name: '{#NAME}: {$N_{#MACRO}:I10}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 10]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 10"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 1187e935064c4f7cb92b789c94e1f950
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 10])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I10}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 4b819b7fa3314b7194fb038569ae93fe
              name: '{#NAME}: {$N_{#MACRO}:I11} (счетчик)'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 11 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 11 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 0d95c633bbc54a91b8e1b7bb49102479
                  expression: 'change(/WB by m-e/wb-mr11[{#DEVICE}/Input 11 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:I11}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:I11}'
                      expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 11])=1'
            - uuid: d7db228850224bbe9c10038caf7b0f9a
              name: '{#NAME}: {$N_{#MACRO}:I11}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Input 11]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input 11"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d754696c059b45df8b4d01e26ebc93dc
                  expression: 'last(/WB by m-e/wb-mr11[{#DEVICE}/Input 11])=1'
                  name: '{#NAME}: {$N_{#MACRO}:I11}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 44d8efb9d6734bdbb577a83c932d51ac
              name: '{#NAME}: {$N_{#MACRO}:K1}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 4c52b89d4d3c4f2db2ce60b811062fc8
              name: '{#NAME}: {$N_{#MACRO}:K2}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: ea622c25664e467c94f2e8842cedf500
              name: '{#NAME}: {$N_{#MACRO}:K3}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: d20b28725cfa418b87c527d0345796b7
              name: '{#NAME}: {$N_{#MACRO}:K4}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K4]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K4"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 2012f6bce5fc48ed961cea0c5f6aa439
              name: '{#NAME}: {$N_{#MACRO}:K5}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K5]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K5"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 946f53fdd75e4ca392b02d3a34eba82c
              name: '{#NAME}: {$N_{#MACRO}:K6}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K6]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K6"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: e6104344e3a344a1ae01dbfee0641ba7
              name: '{#NAME}: {$N_{#MACRO}:K7}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K7]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K7"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 6069a701577e4bf180fbb3553735674b
              name: '{#NAME}: {$N_{#MACRO}:K8}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K8]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K8"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: d69ef62c240f487eb3f8e57af801390a
              name: '{#NAME}: {$N_{#MACRO}:K9}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K9]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K9"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 8b4b6c50232d44bd826b2898476070c5
              name: '{#NAME}: {$N_{#MACRO}:K10}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K10]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K10"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: f0ab6e963ae94ba9a782c6c6e82acb82
              name: '{#NAME}: {$N_{#MACRO}:K11}'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/K11]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/K11"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: 9fe0105740504e1f9e15ba34bcc25e65
              name: '{#NAME}: Напряжение питания датчика'
              type: DEPENDENT
              key: 'wb-mr11[{#DEVICE}/Supply Voltage]'
              history: '{$INPUT_HISTORY}'
              value_type: FLOAT
              trends: '{$INPUT_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Supply Voltage"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: Vin
              trigger_prototypes:
                - uuid: 60786e4d19854a42ade1f1fde4f43513
                  expression: 'nodata(/WB by m-e/wb-mr11[{#DEVICE}/Supply Voltage],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 47d6df07354b437c88916c9ab5aa5b3a
          name: wb-mrgb
          type: TRAP
          key: wb-mrgb.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: a69afa06f6b74389bbf52213accad3e6
              name: '{#NAME}: {$N_{#MACRO}:B1} (счетчик)'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/Button 1 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 1 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: ae781dd7dc5446b9b61de3b47a5642c8
                  expression: 'change(/WB by m-e/wb-mrgb[{#DEVICE}/Button 1 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:B1}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:B1}'
                      expression: 'last(/WB by m-e/wb-mrgb[{#DEVICE}/Button 1])=1'
            - uuid: 3c00443a3e264ed8bcb969d747cab9be
              name: '{#NAME}: {$N_{#MACRO}:B1}'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/Button 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 5c5f678c6e2c4248a3492b9160e50457
                  expression: 'last(/WB by m-e/wb-mrgb[{#DEVICE}/Button 1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:B1}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 08e67a32d23e4983aa1e2065679e7cee
              name: '{#NAME}: {$N_{#MACRO}:B2} (счетчик)'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/Button 2 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 2 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 4877138e23d8481da0c7cb9bb161a8ab
                  expression: 'change(/WB by m-e/wb-mrgb[{#DEVICE}/Button 2 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:B2}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:B2}'
                      expression: 'last(/WB by m-e/wb-mrgb[{#DEVICE}/Button 2])=1'
            - uuid: 15a016146d2f489eb74d0776fe76ac92
              name: '{#NAME}: {$N_{#MACRO}:B2}'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/Button 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d6bf2cea2ce44129a3db6db584b64e2c
                  expression: 'last(/WB by m-e/wb-mrgb[{#DEVICE}/Button 2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:B2}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: b8489a65d4a844d4b6e4af74d06e8fe0
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/RGB/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/RGB/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: 57197d8abb3641b9b918e26dab3353a2
                  expression: 'last(/WB by m-e/wb-mrgb[{#DEVICE}/RGB/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 5fee5d5bd7844e75bea0e4215cc07307
              name: '{#NAME}: {$N_{#MACRO}:RGB}'
              type: DEPENDENT
              key: 'wb-mrgb[{#DEVICE}/RGB]'
              history: '{$INPUT_HISTORY}'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/RGB"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: light
              trigger_prototypes:
                - uuid: 9aa71a2b655f4fa2b488e230e5acadc9
                  expression: 'nodata(/WB by m-e/wb-mrgb[{#DEVICE}/RGB],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 3ba960a51f6948bf96fc7c2daa9b15a0
          name: wb-mrm2
          type: TRAP
          key: wb-mrm2.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: 3fa3c635ac87414cbac7b09019ba0b07
              name: '{#NAME}: {$N_{#MACRO}:B1} (счетчик)'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Button 1 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 1 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: a4da568c958441af8650e76976362314
                  expression: 'change(/WB by m-e/wb-mrm2[{#DEVICE}/Button 1 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:B1}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:B1}'
                      expression: 'last(/WB by m-e/wb-mrm2[{#DEVICE}/Button 1])=1'
            - uuid: 997fb7f92c434b798f80d5e73d8efd95
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Button 1/error]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 1/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: f19840ce5e8a4957afce0991f40fb2a5
                  expression: 'last(/WB by m-e/wb-mrm2[{#DEVICE}/Button 1/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 06966ee8d7344067ae03f5bd6aecacf4
              name: '{#NAME}: {$N_{#MACRO}:B1}'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Button 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d73eff11717c43a0b85419c4f96187cb
                  expression: 'last(/WB by m-e/wb-mrm2[{#DEVICE}/Button 1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:B1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                - uuid: fc184c47deb445649ba3a1d397c0550d
                  expression: 'nodata(/WB by m-e/wb-mrm2[{#DEVICE}/Button 1],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
            - uuid: 2ede9097efa447dfbc260d4145dad29b
              name: '{#NAME}: {$N_{#MACRO}:B2} (счетчик)'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Button 2 counter]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 2 counter"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: counter
              trigger_prototypes:
                - uuid: 2c372077baee4e9ca2e04d5126c1c3bc
                  expression: 'change(/WB by m-e/wb-mrm2[{#DEVICE}/Button 2 counter])<>0'
                  name: '{#NAME}: {$N_{#MACRO}:B2}'
                  priority: WARNING
                  manual_close: 'YES'
                  dependencies:
                    - name: '{#NAME}: {$N_{#MACRO}:B2}'
                      expression: 'last(/WB by m-e/wb-mrm2[{#DEVICE}/Button 2])=1'
            - uuid: 4b0f05598c784b48862eac35a1a1993d
              name: '{#NAME}: {$N_{#MACRO}:B2}'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Button 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Button 2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 1a4e2834a5ee45738d0a6d1300260d0b
                  expression: 'last(/WB by m-e/wb-mrm2[{#DEVICE}/Button 2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:B2}'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 35fec4135e77477284af1d9d3e603780
              name: '{#NAME}: {$N_{#MACRO}:R1}'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Relay 1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Relay 1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
            - uuid: e4e3f6cf53294b9594cfb2c921eb2291
              name: '{#NAME}: {$N_{#MACRO}:R2}'
              type: DEPENDENT
              key: 'wb-mrm2[{#DEVICE}/Relay 2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Relay 2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: relay
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: b1063a58eb284f629a16d9842b11d6e0
          name: wb-ms-thls
          type: TRAP
          key: wb-ms-thls.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: 168a08052cbb4feb83b7601f0340cba8
              name: '{#NAME}: Температура {$N_{#MACRO}:W1}'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/External Sensor 1]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/External Sensor 1"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 23149835d2e94cf6b87070e42169dd7a
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}_W1"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}_W1"}'
                  name: '{#NAME}: Жарко {$N_{#MACRO}:W1}'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 974bc701e8354cd18eeb2ee2ac466adc
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}_W1"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}_W1"}'
                  name: '{#NAME}: Холодно {$N_{#MACRO}:W1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
            - uuid: 22a4a25af7954b5cbe0bd46dddf2c103
              name: '{#NAME}: Температура {$N_{#MACRO}:W2}'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/External Sensor 2]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/External Sensor 2"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 9270e790a4d34a46be391e2437ac3c95
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}_W2"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}_W2"}'
                  name: '{#NAME}: Жарко {$N_{#MACRO}:W2}'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 188866e7801440b2a6086526abe5c017
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}_W2"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}_W2"}'
                  name: '{#NAME}: Холодно {$N_{#MACRO}:W2}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
            - uuid: e0377dbc6b3b405591270855d5f28c40
              name: '{#NAME}: Влажность'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Humidity]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: '%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Humidity"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 976165a1aaeb42f296f4afec041b48df
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Humidity],{$CHECK_INTERVAL})>{$HUMID_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Humidity],{$CHECK_INTERVAL})<{$HUMID_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Высокая влажность'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: humid
                      value: high
            - uuid: 375e5c7b23ca41268f3d367f25aa3870
              name: '{#NAME}: Освещённость'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Illuminance]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              units: lx
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Illuminance"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
            - uuid: f580fb05c0d847b4b14d313c65ee50dd
              name: '{#NAME}: Напряжение питания датчика'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Input Voltage]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input Voltage"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: Vin
              trigger_prototypes:
                - uuid: a0c9d6cda04b464a8e9e25d270759c0e
                  expression: 'nodata(/WB by m-e/wb-ms-thls[{#DEVICE}/Input Voltage],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
            - uuid: f028c2252c7f4a43b079ab1d02df7d82
              name: '{#NAME}: Уровень шума'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Sound Level]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: dB
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Sound Level"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 4af05d3e4bbd49aa941e0cfe36fa2505
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Sound Level],{$CHECK_INTERVAL_SHORT})>{$LOUD_MAX:"{#MACRO}"}'
                  name: '{#NAME}: Шумно'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: loud
                      value: high
            - uuid: 27becec9f924489e915aac3c378814be
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Temperature/error]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temperature/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: 46d10458bdaa48ae9a20d3847d410a80
                  expression: 'last(/WB by m-e/wb-ms-thls[{#DEVICE}/Temperature/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: a753ef872a1043e7bbf3304660c129c0
              name: '{#NAME}: Температура'
              type: DEPENDENT
              key: 'wb-ms-thls[{#DEVICE}/Temperature]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temperature"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 4e7b2465dfc4423fa265690d84620e60
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Temperature],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Temperature],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Жарко'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 20151653ee1c4645b3962b9c9272e1e7
                  expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Temperature],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-ms-thls[{#DEVICE}/Temperature],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}"}'
                  name: '{#NAME}: Холодно'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: 9b7d8a3a99ac42a4a9ea912c329600c4
          name: wb-msw2
          type: TRAP
          key: wb-msw2.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: 6c28b1ec01e04a8192708052f0e5ec33
              name: '{#NAME}: Зуммер'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Buzzer]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Buzzer"].value'
                  error_handler: DISCARD_VALUE
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: buzzer
              trigger_prototypes:
                - uuid: 579ea05929674b8680c58d3eb26ac411
                  expression: 'last(/WB by m-e/wb-msw2[{#DEVICE}/Buzzer])=1'
                  name: '{#NAME}: Зуммер включен'
                  manual_close: 'YES'
                  tags:
                    - tag: buzzer
                      value: 'on'
            - uuid: 50dcf17947114d8bb5917377e6909209
              name: '{#NAME}: Содержание углекислого газа'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/CO2]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              units: ppm
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/CO2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: c0444e19b9e844ce9c973af2cdadcc3f
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/CO2],{$CHECK_INTERVAL_SHORT})>{$CO2_MAX:"{#MACRO}"}'
                  name: '{#NAME}: Высокое содержание углекислого газа'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: CO2
                      value: high
            - uuid: cfb2272f62614344b32efb3e4065ed11
              name: '{#NAME}: Температура {$N_{#MACRO}:W1}'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/External Sensor 1]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/External Sensor 1"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 637fe672e24641b1957db079ddd988af
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}_W1"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}_W1"}'
                  name: '{#NAME}: Жарко {$N_{#MACRO}:W1}'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: bb4ca76d401e4d9dabf9e3508937cd5c
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}_W1"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 1],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}_W1"}'
                  name: '{#NAME}: Холодно {$N_{#MACRO}:W1}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
            - uuid: 4958076bed3144589b9d388c1d46ba05
              name: '{#NAME}: Температура {$N_{#MACRO}:W2}'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/External Sensor 2]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/External Sensor 2"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 089777934c744109847ae483434f578f
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}_W2"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}_W2"}'
                  name: '{#NAME}: Жарко {$N_{#MACRO}:W2}'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 0b744f403bc74cefa421aa414539af07
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}_W2"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/External Sensor 2],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}_W2"}'
                  name: '{#NAME}: Холодно {$N_{#MACRO}:W2}'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
            - uuid: 43cf9753a0c64ff2bfb776296e5eb949
              name: '{#NAME}: Влажность'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Humidity]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: '%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Humidity"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: dcb7845d749f43e7ad1a1209cffb38c8
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Humidity],{$CHECK_INTERVAL})>{$HUMID_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Humidity],{$CHECK_INTERVAL})<{$HUMID_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Высокая влажность'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: humid
                      value: high
            - uuid: 1ad14c8e9b9d445bb6518ef4da2e6f4e
              name: '{#NAME}: Освещённость'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Illuminance]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              units: lx
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Illuminance"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
            - uuid: 17e915ae4ece4d3da643df62c6cf2183
              name: '{#NAME}: Напряжение питания датчика'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Input Voltage]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Input Voltage"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: Vin
              trigger_prototypes:
                - uuid: 187177a8a9024f21b194553c4e93ec8d
                  expression: 'nodata(/WB by m-e/wb-msw2[{#DEVICE}/Input Voltage],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
            - uuid: 07bf3e0ec43d4b20a8c95c0804ba1c79
              name: '{#NAME}: Уровень шума'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Sound Level]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: dB
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/SoundLevel"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: c620e007a4b04e4d80415a244c5a42fa
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Sound Level],{$CHECK_INTERVAL_SHORT})>{$LOUD_MAX:"{#MACRO}"}'
                  name: '{#NAME}: Шумно'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: loud
                      value: high
            - uuid: 5af9975e2c0b4119b47c7fd71fe70da3
              name: '{#NAME}: Ошибка связи с датчиком'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Temperature/error]'
              history: '{$W_HISTORY}'
              trends: '{$W_TREND}'
              valuemap:
                name: mqttErrors
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temperature/meta/error"].value'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var a={
                       "r": 1, // Ошибка чтения
                       "w": 2, // Ошибка записи
                       "rw": 3, // Ошибка чтения и записи
                       "wr": 3, // Ошибка чтения и записи
                      };
                      
                      return a[value]||value;
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: error
              trigger_prototypes:
                - uuid: e97bba64dc7d4ad480e1caa54252c0a8
                  expression: 'last(/WB by m-e/wb-msw2[{#DEVICE}/Temperature/error])<>0'
                  name: '{#NAME}: Ошибка связи с датчиком'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: bb9b8c05bb0049afa2bc32e40d2cc032
              name: '{#NAME}: Температура'
              type: DEPENDENT
              key: 'wb-msw2[{#DEVICE}/Temperature]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/{#DEVICE}/controls/Temperature"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: 26146a5f2dc04efcb0862e1ffa62eec8
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Temperature],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Temperature],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Жарко'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 33c7843dc1e24838b7cd2cb6a6a0ea66
                  expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Temperature],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-msw2[{#DEVICE}/Temperature],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}"}'
                  name: '{#NAME}: Холодно'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: d79860eee86c4fa899c1f9260b313f88
          name: wb-w1
          type: TRAP
          key: wb-w1.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: d9f03f0ae53a441f842cb78f52d8d64d
              name: '{#NAME}: Температура'
              type: DEPENDENT
              key: 'wb-w1[{#DEVICE}]'
              history: '{$W_HISTORY}'
              value_type: FLOAT
              trends: '{$W_TREND}'
              units: С
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-w1/controls/{#DEVICE}"].value'
                  error_handler: DISCARD_VALUE
                - type: IN_RANGE
                  parameters:
                    - '-100'
                    - '100'
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: env
              trigger_prototypes:
                - uuid: dde549d8ac70425eb89357d0c78de9e9
                  expression: 'nodata(/WB by m-e/wb-w1[{#DEVICE}],{$CHECK_NODATA:"{#MACRO}"})=1'
                  name: '{#NAME}: Давно не поступали данные'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
                - uuid: 35b3871a99954fe8abcf158545c70b9d
                  expression: 'avg(/WB by m-e/wb-w1[{#DEVICE}],{$CHECK_INTERVAL})>{$TEMP_MAX:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-w1[{#DEVICE}],{$CHECK_INTERVAL})<{$TEMP_MAX_OK:"{#MACRO}"}'
                  name: '{#NAME}: Жарко'
                  priority: INFO
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: high
                - uuid: 1b1d538deb134affb594389755cb1b8a
                  expression: 'avg(/WB by m-e/wb-w1[{#DEVICE}],{$CHECK_INTERVAL})<{$TEMP_MIN:"{#MACRO}"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'avg(/WB by m-e/wb-w1[{#DEVICE}],{$CHECK_INTERVAL})>{$TEMP_MIN_OK:"{#MACRO}"}'
                  name: '{#NAME}: Холодно'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: temp
                      value: low
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
        - uuid: c09c898836084d97aefbe376719b0b60
          name: wbio-di-wd-14
          type: TRAP
          key: wbio-di-wd-14.lld
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: eb15309f3fba40c39903784be3aa8232
              name: '{#NAME}: {$N_{#MACRO}:IN1}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN1]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN1"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 3422dc06cc744fbc9d6a16f5c449197f
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN1])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN1}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: fb7c42590252439393d31be7ba7cf7e5
              name: '{#NAME}: {$N_{#MACRO}:IN2}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN2]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN2"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 23d98d7f638649f6b83a203af1430bd2
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN2])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN2}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: cb057967ff6a4a44ac1a820c303d9cc6
              name: '{#NAME}: {$N_{#MACRO}:IN3}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN3]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN3"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: c7ebd5c811d542748f7f1a6999d2180c
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN3])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN3}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 154369172e134c72bb756e5b230def14
              name: '{#NAME}: {$N_{#MACRO}:IN4}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN4]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN4"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 3ed86da92c84499ea96b9549b0ee45e3
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN4])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN4}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 37bda7f69e0c46619750890d2920ae9b
              name: '{#NAME}: {$N_{#MACRO}:IN5}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN5]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN5"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 37a102f28a5643e3811219e80ffcaefd
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN5])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN5}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 3410549c375a408c88529873ebfd3267
              name: '{#NAME}: {$N_{#MACRO}:IN6}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN6]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN6"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: ea4e1d90a810458192aca829e5220bad
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN6])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN6}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: f444858b7cf749ba936b3842525857cf
              name: '{#NAME}: {$N_{#MACRO}:IN7}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN7]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN7"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 0d283773cd94404f9d53472354056c46
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN7])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN7}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 9d229f0f56ed4cbb9bef2339b583cce1
              name: '{#NAME}: {$N_{#MACRO}:IN8}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN8]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN8"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: d801e9d36ca14a999674048f0d661199
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN8])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN8}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 26028cd1ac69432286a029e02464e889
              name: '{#NAME}: {$N_{#MACRO}:IN9}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN9]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN9"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: dcb8c44d584f4ee3bbae2172c5987a32
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN9])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN9}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: c61021676bb14a6a9bbd2e608b04c9ea
              name: '{#NAME}: {$N_{#MACRO}:IN10}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN10]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN10"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 5d53522729fc46b39e91776cb55519e8
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN10])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN10}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: f4292f561df24068a571919a43a94211
              name: '{#NAME}: {$N_{#MACRO}:IN11}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN11]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN11"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 27c87b8fad664c328d14e7f7cc8016da
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN11])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN11}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 9c7bd8e2d375416d8ff1f46f4b551e74
              name: '{#NAME}: {$N_{#MACRO}:IN12}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN12]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN12"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 9e6150ddf4f749c3a89e3c293b4067a5
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN12])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN12}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: c3415a3679fa4bd69b063f2c0fb64395
              name: '{#NAME}: {$N_{#MACRO}:IN13}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN13]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN13"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 33d4c547d53d4036a3033cc36a1afed6
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN13])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN13}'
                  priority: WARNING
                  manual_close: 'YES'
            - uuid: 4e1b7f9302cd4ee1b5145f19d994d422
              name: '{#NAME}: {$N_{#MACRO}:IN14}'
              type: DEPENDENT
              key: 'wbio-di-wd-14[{#DEVICE}_IN14]'
              history: '{$INPUT_HISTORY}'
              trends: '{$INPUT_TREND}'
              valuemap:
                name: mqttDryInput
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.["/devices/wb-gpio/controls/{#DEVICE}_IN14"].value'
                  error_handler: DISCARD_VALUE
              master_item:
                key: 'mqtt[metrics]'
              tags:
                - tag: mqtt
                  value: '{#DEVICE}'
                - tag: type
                  value: dry
              trigger_prototypes:
                - uuid: 60780560e2974cc38bd09506187163b4
                  expression: 'last(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN14])=1'
                  name: '{#NAME}: {$N_{#MACRO}:IN14}'
                  priority: WARNING
                  manual_close: 'YES'
                - uuid: 3f9b08545a1841cb9c67ee99412125e6
                  expression: '(nodata(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN14],{$CHECK_NODATA:"{#MACRO}"})=1) or (changecount(/WB by m-e/wbio-di-wd-14[{#DEVICE}_IN14],{$CHECK_NODATA:"{#MACRO}"})=0)'
                  name: '{#NAME}: {$N_{#MACRO}:IN14} давно не включался'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: error
                      value: nodata
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var obj=JSON.parse(value);
                  for (i = 0; i < Object.keys(obj).length; i++) {
                   if (!obj[i]["{#NAME}"]) {
                    var name=obj[i]["{#DEVICE}"].toUpperCase().replace("-","_");
                    obj[i]["{#MACRO}"]=name;
                    obj[i]["{#NAME}"]="{$N_"+name+"}";
                   }
                  }
                  return JSON.stringify(obj)
      tags:
        - tag: mqtt
          value: '{$N_MQTT}'
      macros:
        - macro: '{$CHECK_INTERVAL}'
          value: 30m
          description: 'отрезки времени для обычных проверок (температура, влажность)'
        - macro: '{$CHECK_INTERVAL_SHORT}'
          value: 5m
          description: 'отрезки времени для быстрых проверок (напряжение в электросети, CO2, уровень шума)'
        - macro: '{$CHECK_NODATA}'
          value: 15m
          description: 'допустимый отрезок времени без новых данных'
        - macro: '{$CHECK_NODATA:"EXT1"}'
          value: 4h
        - macro: '{$CHECK_NODATA:"WB_MCM16_1"}'
          value: 4h
        - macro: '{$CO2_MAX}'
          value: '1000'
          description: 'максимальный уровень CO2'
        - macro: '{$HUMID_MAX}'
          value: '62'
          description: 'максимальная влажность, сработка'
        - macro: '{$HUMID_MAX_OK}'
          value: '60'
          description: 'максимальная влажность, покой'
        - macro: '{$INPUT_HISTORY}'
          value: 14d
          description: 'история  сухих входов'
        - macro: '{$INPUT_TREND}'
          value: 30d
          description: 'тренды  сухих входов'
        - macro: '{$LOUD_MAX}'
          value: '75'
          description: 'максимальный уровень шума'
        - macro: '{$M_URL}'
          value: 'http://127.0.0.1:8080/v1'
          description: 'адрес для получения метрик'
        - macro: '{$N_EXT1}'
          value: WBIO-DI-WD-14
          description: 'понятное название датчика'
        - macro: '{$N_EXT1:IN1}'
          value: 'Утечка газа'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN2}'
          value: 'Минимальное давление газа'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN3}'
          value: 'Авария котла'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN4}'
          value: 'Авария глубинного насоса'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN5}'
          value: 'Минимальное давление воды'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN6}'
          value: 'Протечка воды'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN7}'
          value: 'Авария приточно-вытяжной вентиляции'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN8}'
          value: 'Отсутствие входящей электроэнергии'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN9}'
          value: 'Работает генератор'
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN10}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN11}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN12}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN13}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_EXT1:IN14}'
          value: Автотест
          description: 'понятное название входа датчика'
        - macro: '{$N_MQTT}'
          value: WirenBoard
          description: 'понятное название WirenBoard'
        - macro: '{$N_WB_MCM16_1:I1}'
          value: 'Утечка газа'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I2}'
          value: 'Минимальное давление газа'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I3}'
          value: 'Авария котла'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I4}'
          value: 'Авария глубинного насоса'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I5}'
          value: 'Минимальное давление воды'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I6}'
          value: 'Протечка воды'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I7}'
          value: 'Авария приточно-вытяжной вентиляции'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I8}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I9}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I10}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I11}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I12}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I13}'
          value: (резерв)
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I14}'
          value: Автотест
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I15}'
          value: 'Отсутствие входящей электроэнергии'
          description: 'понятное название входа датчика'
        - macro: '{$N_WB_MCM16_1:I16}'
          value: 'Работает генератор'
          description: 'понятное название входа датчика'
        - macro: '{$TEMP_MAX}'
          value: '40'
          description: 'максимальная температура, сработка'
        - macro: '{$TEMP_MAX_OK}'
          value: '38'
          description: 'максимальная температура, покой'
        - macro: '{$TEMP_MIN}'
          value: '13'
          description: 'минимальная температура, сработка'
        - macro: '{$TEMP_MIN_OK}'
          value: '15'
          description: 'минимальная температура, покой'
        - macro: '{$VOLTAGE_MAX_DELTA}'
          value: '0.4'
          description: 'максимально допустимый разброс значений'
        - macro: '{$VOLTAGE_MIN}'
          value: '11'
          description: 'минимальное напряжение питания датчиков, сработка'
        - macro: '{$VOLTAGE_MIN_OK}'
          value: '11.5'
          description: 'минимальное напряжение питания датчиков, покой'
        - macro: '{$W_HISTORY}'
          value: 30d
          description: 'история погоды'
        - macro: '{$W_TREND}'
          value: 90d
          description: 'тренды погоды'
      valuemaps:
        - uuid: 309f6e45e9dc4fb2b9286a25c0885847
          name: mqttDryInput
          mappings:
            - value: '0'
              newvalue: Разомкнут
            - value: '1'
              newvalue: Замкнут
        - uuid: a8a6180f7e8946c8950cd580ebc3b0f4
          name: mqttErrors
          mappings:
            - newvalue: 'Нет ошибок'
            - value: '0'
              newvalue: 'Нет ошибок'
            - value: '1'
              newvalue: 'Ошибка чтения'
            - value: '2'
              newvalue: 'Ошибка записи'
            - value: '3'
              newvalue: 'Ошибка чтения/записи'
            - value: r
              newvalue: 'Ошибка чтения'
            - value: rw
              newvalue: 'Ошибка чтения/записи'
            - value: w
              newvalue: 'Ошибка записи'
